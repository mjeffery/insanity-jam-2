!function(a){function b(a,b,c,d){_.extend(this,{state:"relaxed",torso:{joint:a,options:_.defaults(b||{},{extended:{limit:-Math.PI/8,motorDir:1},retracted:{limit:3*Math.PI/4,motorDir:-1}})},limb:{joint:c,options:_.defaults(d||{},{extended:{limit:-Math.PI/8,motorDir:1},retracted:{limit:3*Math.PI/4,motorDir:-1}})}})}b.prototype={extend:function(a){var b=this.limb,c=this.torso;this.driveJoint(c.joint,a,c.options.extended),this.driveJoint(b.joint,a,b.options.extended),this.state="extending"},retract:function(a){var b=this.limb,c=this.torso;this.driveJoint(c.joint,a,c.options.retracted),this.driveJoint(b.joint,a,b.options.retracted),this.state="retracting"},update:function(){},driveJoint:function(a,b,c){c.motorDir>0?a.lowerLimit=c.limit:a.upperLimit=c.limit,a.motorIsEnabled()||a.enableMotor(),a.setMotorSpeed(b*c.motorDir)},mirror:function(a,c){function d(a){return{limit:-a.limit,motorDir:-a.motorDir}}function e(a){return{retracted:d(a.retracted),extended:d(a.extended)}}return new b(a,e(this.torso.options),c,e(this.limb.options))}},a.LimbController=b}(this),function(a){function b(a,b,c){var d=a.physics;this.game=a,this.debug=!!c,this.collisionGroups={bodyParts:d.p2.createCollisionGroup(),world:b};var e=this.left={},f=this.right={};e.thigh=this.addPart(335,335.6,"robot thigh left"),f.thigh=this.addPart(407.6,339.1,"robot thigh right"),e.arm=this.addPart(100,100,"robot arm left"),f.arm=this.addPart(300,100,"robot arm right");var g=this.torso=this.addPart(375,228.6,"robot torso"),h=this.head=this.addPart(370,180,"robot head");h.mass=1,e.foot=this.addPart(298.5,436.5,"robot foot left"),e.foot.body.mass=1,f.foot=this.addPart(460.6,458.3,"robot foot right"),f.foot.body.mass=1,e.hand=this.addPart(200,300,"robot hand left"),f.hand=this.addPart(400,300,"robot hand right"),e.knee=this.addJoint(e.foot,[22,-69],e.thigh,[-4,61]),f.knee=this.addJoint(f.foot,[-33,-71],f.thigh,[2,62]),e.hip=this.addJoint(e.thigh,[12,-58],g,[-18,53]),f.hip=this.addJoint(f.thigh,[-14,-57],g,[15,55]),e.shoulder=this.addJoint(e.arm,[20,-44],g,[-37,-42]),f.shoulder=this.addJoint(f.arm,[-21,-45],g,[39,-36]),e.elbow=this.addJoint(e.hand,[-7,63],e.arm,[-31,51]),f.elbow=this.addJoint(f.hand,[6,60],f.arm,[30,52]),this.neck=this.addJoint(g,[0,-49],h,[0,0]),e.legController=new LimbController(e.hip,{retracted:{limit:-3*Math.PI/4,motorDir:1},extended:{limit:Math.PI/8,motorDir:-1}},e.knee,{retracted:{limit:3*Math.PI/4,motorDir:-1},extended:{limit:-Math.PI/8,motorDir:1}}),e.armController=new LimbController(e.shoulder,{retracted:{limit:Math.PI/8,motorDir:-1},extended:{limit:-3*Math.PI/8,motorDir:1}},e.elbow,{retracted:{limit:-Math.PI/8,motorDir:2},extended:{limit:Math.PI,motorDir:-1.75}}),f.legController=e.legController.mirror(f.hip,f.knee),f.armController=e.armController.mirror(f.shoulder,f.elbow)}_.extend(b,{preload:function(a){a.image("robot head","assets/robot head.2405000f.png"),a.image("robot torso","assets/robot torso.c970430b.png"),a.image("robot thigh left","assets/robot thigh left.e37012d3.png"),a.image("robot thigh right","assets/robot thigh right.90cc9458.png"),a.image("robot foot left","assets/robot foot left.7a35da61.png"),a.image("robot foot right","assets/robot foot right.f0693a46.png"),a.image("robot arm left","assets/robot arm left.976d7564.png"),a.image("robot arm right","assets/robot arm right.bd9ece10.png"),a.image("robot hand left","assets/robot hand left.519a8619.png"),a.image("robot hand right","assets/robot hand right.6355453c.png"),a.physics("robot physics","assets/robot.e96213a0.json")}}),b.prototype={addPart:function(a,b,c){var d=this.game.add.sprite(a,b,c);return this.game.physics.p2.enable(d,this.debug),d.body.clearShapes(),d.body.loadPolygon("robot physics",c),d.body.setCollisionGroup(this.collisionGroups.bodyParts),d.body.collides(this.collisionGroups.world),d},addJoint:function(a,b,c,d){var e=this.game.physics.p2.createRevoluteConstraint(a,b,c,d);return e.upperLimitEnabled=!0,e.upperLimit=Math.PI/8,e.lowerLimitEnabled=!0,e.lowerLimit=-Math.PI/8,e},squat:function(){this.left.legController.retract(1),this.right.legController.retract(1)},jump:function(){this.left.legController.extend(10),this.right.legController.extend(10)},punch:function(){this.left.armController.extend(5),this.right.armController.extend(5)},defend:function(){this.left.armController.retract(3),this.right.armController.retract(3)},destroy:function(){}},a.Robot=b}(this),function(a){function b(){}b.prototype={preload:function(){this.load.image("loading-bar","assets/loading bar.f44b1a70.png"),this.load.image("loading-bar-bg","assets/loading bar bg.1fe86dc8.png")},create:function(){this.state.start("preload")}},a.Boot=b}(this),function(a){function b(){}b.prototype={preload:function(){var a=250,b=296,c=this.add,d=this.load;c.sprite(a,b,"loading-bar-bg");var e=c.sprite(a,b,"loading-bar");d.setPreloadSprite(e),d.bitmapFont("minecraftia","assets/minecraftia.d0c5b06a.png","assets/minecraftia.22ff6d4c.xml"),Robot.preload(d),Game.preload(d),d.onLoadComplete.addOnce(this.onLoadComplete,this)},create:function(){this.stage.backgroundColor="#000000"},onLoadComplete:function(){this.state.start("game")}},a.Preload=b}(this),function(a){function b(){}b.preload=function(a){a.image("dirt","assets/dirt.f386c547.png")},b.prototype={create:function(){var a=this.game.physics,b=this.add,c=!1;this.game.stage.setBackgroundColor("#6495ED"),a.startSystem(Phaser.Physics.P2JS),a.p2.gravity.y=300;var d=a.p2.createCollisionGroup(),e=this.robot=new Robot(this.game,d,c),f=b.tileSprite(400,568,800,64,"dirt",0);a.p2.enable(f,c),f.body.setRectangleFromSprite(f),f.body.static=!0,f.body.setCollisionGroup(d),f.body.collides(e.collisionGroups.bodyParts);var g=this.input.keyboard.createCursorKeys();g.down.onDown.add(e.squat,e),g.up.onDown.add(e.jump,e),g.left.onDown.add(e.defend,e),g.right.onDown.add(e.punch,e),b.bitmapText(150,20,"minecraftia",'Press "DOWN" to squat and "UP" to jump!',16),b.bitmapText(130,40,"minecraftia",'Press "RIGHT" to punch and "LEFT" to defend!',16)},update:function(){}},a.Game=b}(this);var game=new Phaser.Game(800,600,Phaser.AUTO,"game-container");game.state.add("boot",Boot),game.state.add("preload",Preload),game.state.add("game",Game),game.state.start("boot");